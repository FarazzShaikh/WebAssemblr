function e(e,t){throw new TypeError(`unexpected tag 0x${e.toString(16)} (${t} expected)`)}function t(e){return 127&e}function r(e){return 0==(128&e)}function n(e){return 224==(224&e)}function i(e){return 160==(224&e)}function s(e){return 144==(240&e)}function c(e){return 128==(240&e)}function u(e,t,r){const n=t.byteLength;if(n<=255)e.putUi8(r),e.putUi8(n);else if(n<=65535)e.putUi8(r+1),e.putUi16(n);else{if(!(n<=4294967295))throw new RangeError("length limit exceeded");e.putUi8(r+2),e.putUi32(n)}e.put(t)}function a(t){const r=t.getUi8();let n;switch(r){case 192:n=0;break;case 196:case 217:n=t.getUi8();break;case 197:case 218:n=t.getUi16();break;case 198:case 219:n=t.getUi32();break;default:i(r)||e(r,"bytes or string"),n=function(e){return 31&e}(r)}return t.get(n)}function o(e,t){t<16?e.putUi8(144|15&t):l(e,220,t)}function f(e,t){const r=e.getUi8(),n=s(r)?function(e){return 15&e}(r):U(e,r,220,"array");if(null!=t&&n!==t)throw new Error(`invalid array header size ${n}`);return n}function y(e,t){t<16?e.putUi8(128|15&t):l(e,222,t)}function p(e,t){const r=e.getUi8(),n=c(r)?function(e){return 15&e}(r):U(e,r,222,"map");if(null!=t&&n!==t)throw new Error(`invalid map header size ${n}`);return n}function l(e,t,r){if(r<=65535)e.putUi8(t),e.putUi16(r);else{if(!(r<=4294967295))throw new RangeError("length limit exceeded");e.putUi8(t+1),e.putUi32(r)}}function U(t,r,n,i){switch(r){case 192:return 0;case n:return t.getUi16();case n+1:return t.getUi32();default:e(r,i)}}const g={enc(e,t){(function(e){switch(typeof e){case"undefined":return h;case"boolean":return d;case"number":return isFinite(e)&&Math.floor(e)===e?e<0?w:m:b;case"string":return E;case"object":return null===e?h:Array.isArray(e)?T:e instanceof Uint8Array||e instanceof ArrayBuffer?A:e instanceof Date?I:B;default:throw new TypeError("unsupported type "+typeof e)}})(t).enc(e,t)},dec:e=>function(e){switch(e){case 192:return h;case 194:case 195:return d;case 208:case 209:case 210:case 211:return w;case 204:case 205:case 206:case 207:return m;case 202:case 203:return b;case 196:case 197:case 198:return A;case 217:case 218:case 219:return E;case 220:case 221:return T;case 222:case 223:return B;case 214:case 215:case 199:return I;default:if(r(e)||n(e))return w;if(i(e))return E;if(s(e))return T;if(c(e))return B;throw new TypeError(`unsupported tag ${e}`)}}(e.peek()).dec(e)},h={enc(e,t){e.putUi8(192)},dec(t){const r=t.getUi8();return 192!==r&&e(r,"nil"),null}},d={enc(e,t){e.putUi8(t?195:194)},dec(t){const r=t.getUi8();switch(r){case 192:case 194:return!1;case 195:return!0;default:e(r,"bool")}}},w={enc(e,r){-128<=r&&r<=127?r>=0?e.putUi8(t(r)):r>-32?e.putUi8(224|31&r):(e.putUi8(208),e.putUi8(r)):-32768<=r&&r<=32767?(e.putI8(209),e.putI16(r)):-2147483648<=r&&r<=2147483647?(e.putI8(210),e.putI32(r)):(e.putI8(211),e.putI64(r))},dec(t){const i=t.getUi8();if(r(i))return function(e){return 127&e}(i);if(n(i))return function(e){return e-256}(i);switch(i){case 192:return 0;case 208:return t.getI8();case 209:return t.getI16();case 210:return t.getI32();case 211:return t.getI64();case 204:return t.getUi8();case 205:return t.getUi16();case 206:return t.getUi32();case 207:return t.getUi64();default:e(i,"int")}}},m={enc(e,r){if(r<0)throw new Error(`not an uint: ${r}`);r<=127?e.putUi8(t(r)):r<=255?(e.putUi8(204),e.putUi8(r)):r<=65535?(e.putUi8(205),e.putUi16(r)):r<=4294967295?(e.putUi8(206),e.putUi32(r)):(e.putUi8(207),e.putUi64(r))},dec(e){const t=w.dec(e);if(t<0)throw new RangeError("uint underflow");return t}},b={enc(e,t){e.putUi8(203),e.putF(t)},dec(t){const r=t.getUi8();switch(r){case 192:return 0;case 202:return t.getF32();case 203:return t.getF64();default:e(r,"float")}}},A={enc(e,t){u(e,t,196)},dec:a},E={enc(e,t){const r=function(e){const t=e.length,r=new Uint8Array(4*t);let n,i=0,s=0;for(;s<t;)n=e.charCodeAt(s++),55296==(64512&n)&&(n=(n<<10)+e.charCodeAt(s++)-56613888),n<128?r[i++]=n:n<2048?(r[i++]=192+(n>>6),r[i++]=128+(63&n)):n<65536?(r[i++]=224+(n>>12),r[i++]=128+(n>>6&63),r[i++]=128+(63&n)):(r[i++]=240+(n>>18),r[i++]=128+(n>>12&63),r[i++]=128+(n>>6&63),r[i++]=128+(63&n));return r.buffer.slice(0,i)}(t);r.byteLength<32?(e.putUi8(160|31&r.byteLength),e.put(r)):u(e,r,217)},dec:e=>function(e){return new TextDecoder("utf-8").decode(e)}(a(e))},I={enc(e,t){const r=t.getTime();e.putUi8(199),e.putUi8(12),e.putI8(-1),e.putUi32(r%1e3*1e6),e.putI64(r/1e3)},dec(t){const r=t.getUi8();switch(r){case 214:if(-1===t.getI8())return new Date(1e3*t.getUi32());break;case 215:if(-1===t.getI8()){const e=t.getUi32(),r=t.getUi32();return new Date(1e3*(r+4294967296*(3&e))+e/4e6)}break;case 199:if(12===t.getUi8()&&-1===t.getI8()){const e=t.getUi32(),r=t.getI64();return new Date(1e3*r+e/1e6)}}e(r,"time")}},T=(_=g,{encHeader:o,decHeader:f,enc(e,t){o(e,t.length),t.forEach((t=>_.enc(e,t)))},dec(e){const t=[];for(let r=f(e);r>0;--r)t.push(_.dec(e));return t}});var _;const B=function(e,t){return{encHeader:y,decHeader:p,enc(r,n){const i=Object.keys(n);y(r,i.length),i.forEach((i=>{e.enc(r,i),t.enc(r,n[i])}))},dec(r){const n={};for(let i=p(r);i>0;--i){n[e.dec(r)]=t.dec(r)}return n}}}(g,g);function S(e,t){const r=function(){let e=new DataView(new ArrayBuffer(64)),t=0;function r(r){if(t+r>e.byteLength){const n=new Uint8Array(Math.max(t+r,e.byteLength+64));n.set(new Uint8Array(e.buffer.slice(0,t))),e=new DataView(n.buffer)}}return{put(n){r(n.byteLength),new Uint8Array(e.buffer).set(new Uint8Array(n),t),t+=n.byteLength},putI8(n){r(1),e.setInt8(t,n),++t},putI16(n){r(2),e.setInt16(t,n),t+=2},putI32(n){r(4),e.setInt32(t,n),t+=4},putI64(n){r(8);const i=n<0;i&&(n=-n);let s=n/4294967296|0,c=n%4294967296|0;i&&(c=1+~c|0,s=0===c?1+~s|0:~s),e.setUint32(t,s),e.setUint32(t+4,c),t+=8},putUi8(n){r(1),e.setUint8(t,n),++t},putUi16(n){r(2),e.setUint16(t,n),t+=2},putUi32(n){r(4),e.setUint32(t,n),t+=4},putUi64(n){r(8),e.setUint32(t,n/4294967296|0),e.setUint32(t+4,n%4294967296),t+=8},putF(n){r(8),e.setFloat64(t,n),t+=8},ui8array:()=>new Uint8Array(e.buffer.slice(0,t))}}();return(t||g).enc(r,e),r.ui8array()}function F(e,t){return(t||g).dec(function(e){let t=ArrayBuffer.isView(e)?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(e),r=0;return{peek:()=>t.getUint8(r),get(e){r+=e;const n=t.byteOffset;return t.buffer.slice(n+r-e,n+r)},getI8:()=>t.getInt8(r++),getI16:()=>(r+=2,t.getInt16(r-2)),getI32:()=>(r+=4,t.getInt32(r-4)),getI64:()=>(r+=8,4294967296*t.getInt32(r-8)+t.getUint32(r-4)),getUi8:()=>t.getUint8(r++),getUi16:()=>(r+=2,t.getUint16(r-2)),getUi32:()=>(r+=4,t.getUint32(r-4)),getUi64:()=>(r+=8,4294967296*t.getUint32(r-8)+t.getUint32(r-4)),getF32:()=>(r+=4,t.getFloat32(r-4)),getF64:()=>(r+=8,t.getFloat64(r-8))}}(e))}const P={env:{memory:new WebAssembly.Memory({initial:512})},wasi_snapshot_preview1:{proc_exit:function(){},fd_close:function(){},fd_write:function(){},fd_seek:function(){}}};class Y{constructor(){this.functions={},this.memmoryBuffers={}}async init(e){let t;if("object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node)t=require("fs").readFileSync(e);else{const r=await fetch(e);t=await r.arrayBuffer()}try{const e=await WebAssembly.instantiate(t,P);this.free=e.instance.exports.free,this.malloc=e.instance.exports.malloc;const r=e.instance.exports.memory;this.memmoryBuffers.Int8Array=new Int8Array(r.buffer),this.memmoryBuffers.Uint8Array=new Uint8Array(r.buffer),this.memmoryBuffers.Int16Array=new Int16Array(r.buffer),this.memmoryBuffers.Uint16Array=new Uint16Array(r.buffer),this.memmoryBuffers.Int32Array=new Int32Array(r.buffer),this.memmoryBuffers.Uint32Array=new Uint32Array(r.buffer),this.memmoryBuffers.Float32Array=new Float32Array(r.buffer),this.memmoryBuffers.Float64Array=new Float64Array(r.buffer);for(const t in e.instance.exports){const r=e.instance.exports[t];this.functions[t]=(e,...t)=>this._call(r,t,e)}}catch(e){throw e}return this.functions}_call(e,t,r){if(r){let n=this._isTypedArray(r);!n&&Array.isArray(r)&&(n=!0,r=Int8Array.from(r));const i=n?"array":r,s=n?r.constructor.name:Y.TYPES.int8,c=[];for(let e of t)if("string"==typeof e&&(e=(new TextEncoder).encode(e)),this._isTypedArray(e)){let t=null;try{const r=e,n=r.length,i=r.constructor.name;t=this.malloc(r.length*r.BYTES_PER_ELEMENT);const s=this.memmoryBuffers[i];if(t){switch(i){case Y.TYPES.int8:case Y.TYPES.uint8:s.set(r,t);case Y.TYPES.int16:case Y.TYPES.uint16:s.set(r,t>>1);break;case Y.TYPES.int32:case Y.TYPES.uint32:case Y.TYPES.float:s.set(r,t>>2);break;case Y.TYPES.double:s.set(r,t>>3)}t&&c.push(t),c.push(n)}}catch(e){throw e}finally{t&&this.free(t)}}else if("object"==typeof e){const t=S(e),r=this.malloc(t.length),n=t.BYTES_PER_ELEMENT;this.memmoryBuffers[Y.TYPES.int8].set(t,r/n),c.push(r),c.push(t.length)}else"number"==typeof e&&c.push(e);if(this._isTypedArray(r)){const t=e(...c);return this._decodeArray(s,t,r),r}if("string"===i){const t=e(...c);return this._decodeUTF8String(s,t)}if("object"===i){const t=e(...c),r=new Uint8Array(this.memmoryBuffers[s].slice(t,t+(t>>2)));return this.free(t),F(r)}return e(...c)}throw"Return Type not defined"}_isTypedArray(e){return void 0!==e.BYTES_PER_ELEMENT}_decodeArray(e,t,r){const n=this.memmoryBuffers[e],i=r.length;for(let e=0;e<(i||1);e++)r[e]=n[t/n.BYTES_PER_ELEMENT+e]}_decodeUTF8String(e,t){const r=this.memmoryBuffers[e];let n="";for(let e=0;r[t+e];e++)n+=String.fromCharCode(r[t/r.BYTES_PER_ELEMENT+e]);return n}}Y.TYPES={int8:"Int8Array",uint8:"Uint8Array",int16:"Int16Array",uint16:"Uint16Array",int32:"Int32Array",uint32:"Uint32Array",float:"Float32Array",double:"Float64Array"};export{Y as WASMlr};
//# sourceMappingURL=web-bundle.js.map
